<!DOCTYPE html>
<html>
<head>
  <title>PSK / Shift DC Encoder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: sans-serif; padding: 10px; margin: 0; background: #111; color: #eee; }
    h1 { text-align: center; font-size: 1.5em; margin: 10px 0; }
    label { margin-top: 12px; display: block; }
    input, select, textarea, button {
      width: 100%; font-size: 1em; padding: 10px; margin-top: 5px;
      background: #222; color: #eee; border: 1px solid #444;
      border-radius: 5px; box-sizing: border-box;
    }
    textarea { resize: vertical; }
    button { background: #333; border: none; margin-top: 10px; cursor: pointer; }
    button:hover { background: #444; }
    .row { display: flex; gap: 10px; margin-top: 5px; }
    .row > div { flex: 1; }
    #statusMessage { margin-top: 6px; font-size: 0.9em; color: #66bb6a; min-height: 1.2em; }
    @media (max-width: 480px) { .row { flex-direction: column; } }
  </style>
</head>
<body>

  <h1>PSK / Shift DC Encoder</h1>

  <label>Input Text:</label>
  <textarea id="text" rows="3" placeholder="Type your message..."></textarea>

  <label>Or Upload Binary File:</label>
  <input type="file" id="fileInput" accept="*/*">

  <div class="row">
    <div>
      <label>CPM:</label>
      <input type="number" id="cpm" value="120" min="1">
    </div>
    <div>
      <label>Sample Rate:</label>
      <select id="sampleRate">
        <option value="8000">8000</option>
        <option value="16000">16000</option>
        <option value="22050">22050</option>
        <option value="32000">32000</option>
        <option value="44100" selected>44100</option>
        <option value="48000">48000</option>
        <option value="96000">96000</option>
        <option value="192000">192000</option>
      </select>
    </div>
  </div>

  <label>Mode:</label>
  <select id="mode">
    <option value="psk">PSK (Phase Shift)</option>
    <option value="shift-dc">Shift DC Offset</option>
  </select>

  <button onclick="encodeAudio()">Encode</button>
  <button onclick="playAudio()">Play</button>
  <button onclick="stopAudio()">Stop</button>
  <button onclick="downloadAudio()">Download Audio</button>

  <label>Binary Output:</label>
  <textarea id="output" rows="6" readonly></textarea>
  <div id="statusMessage"></div>

  <script>
    let audioBuffer, context, source;
    let audioReady = false;
    let uploadedBinary = null;

    function textToBinary(text) {
      return text.split('').map(c => c.charCodeAt(0
